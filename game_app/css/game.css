:root {
  --grid-size: 48px;
  --path-thickness: 6px;
  --blocked-green:#9FE7A0;
  --path-orange:#f97316;
  --z-grid: 1;
  --z-images: 10;
  --z-label: 20;
  --z-transport: 30;
  --z-avatar: 40;
  --z-modal: 1000;
  --z-hud: 1200;
}

.hud { position: sticky; top: 0; z-index: var(--z-hud); display: grid; grid-template-columns: 1fr 1fr 1fr; gap:.5rem; align-items:center; padding:.5rem; background:#ffffffcc; backdrop-filter:saturate(140%) blur(8px); border-bottom:1px solid #e2e8f0; }
.hud .pill { margin-right:.5rem; }
.hud .hud-left, .hud .hud-mid, .hud .hud-right { display:flex; align-items:center; }
.hud .hud-right { justify-content:end; gap:.5rem; }
.pill { display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .6rem; border-radius:999px; border:1px solid #e2e8f0; background:#fff; font-weight:600; white-space:nowrap; }
.pill.co2{ color:#1e293b } .pill.coins{ color:#0b5 } .pill.trees{ color:#228b22 } .pill.day{ color:#334155 }

.banner { display:none; margin:0; padding:.6rem 1rem; border-bottom:1px solid #e2e8f0; }
.banner.show { display:block; }

.game-wrap { max-width: 1200px; margin:1rem auto; padding:0 1rem 3rem; position:relative; }

.map { position:relative; display:grid; grid-template-columns:repeat(15, var(--grid-size)); grid-template-rows:repeat(10, var(--grid-size)); border:1px solid #e2e8f0; border-radius:.8rem; overflow:hidden; box-shadow:0 10px 30px rgba(2,6,23,.05); }
.tile { position:relative; width:var(--grid-size); height:var(--grid-size); display:grid; place-items:center; font-size:20px; user-select:none; transition: transform .08s ease, box-shadow .12s ease; }

/* Blocked areas are green; roads are orange; POI tiles are white */
.t-road { background: var(--path-orange); }
.t-park, .t-water, .t-block { background: var(--blocked-green); }
.t-poi { background: #fff; }

.tile[data-poi] { position:relative; }
.tile[data-poi]:hover { box-shadow: inset 0 0 0 3px rgba(2,132,199,.25); }

/* POI artwork overlay (240x240) */
.poi-art { position:absolute; width:calc(var(--grid-size) * 2); height:calc(var(--grid-size) * 2); left:0; top:0; transform:none; background-repeat:no-repeat; background-position:center center; background-size: calc(var(--grid-size) * 2) calc(var(--grid-size) * 2); pointer-events:none; z-index: var(--z-images); }
.poi-label { position:absolute; left:50%; bottom:2px; transform:translateX(-50%); font-size: 12px; color: #374151; padding:2px 6px; border-radius:12px; background:#ffffffd0; border:1px solid #e5e7eb; z-index: var(--z-label); }

/* Category tints */
.poi-home { background: color-mix(in hsl, var(--home), white 68%); }
.poi-school { background: color-mix(in hsl, var(--school), white 68%); }
.poi-company { background: color-mix(in hsl, var(--company), white 72%); }
.poi-food { background: color-mix(in hsl, var(--food), white 70%); }
.poi-coffee { background: color-mix(in hsl, var(--coffee), white 70%); }
.poi-fine { background: color-mix(in hsl, var(--fine), white 70%); }
.poi-bus { background: #f5f5f4; }

/* POI art bindings (PNG) applied to .poi-art overlay */
.poi-art-home { background-image: url('../assets/images/home_floorplan.png'); }
.poi-art-entrance-bus { background-image: url('../assets/images/entrance_bus.png'); }
.poi-art-school { background-image: url('../assets/images/school_campus.png'); }
.poi-art-company { background-image: url('../assets/images/company_block.png'); }
.poi-art-stall-pho { background-image: url('../assets/images/stall_pho.png'); }
.poi-art-stall-lunch { background-image: url('../assets/images/stall_lunch.png'); }
.poi-art-stall-dessert { background-image: url('../assets/images/stall_dessert.png'); }
.poi-art-cafe { background-image: url('../assets/images/cafe.png'); }
.poi-art-fine-dining { background-image: url('../assets/images/fine_dining.png'); }
.poi-art-bus-stop { background-image: url('../assets/images/bus_stop.png'); }

.avatar { position:absolute; width:var(--grid-size); height:var(--grid-size); display:grid; place-items:center; font-size:26px; transform:translate(0,0); transition: transform .12s linear; pointer-events:none; z-index: var(--z-avatar, 40); }

/* Transport moving sprite */
.vehicle-sprite { position:absolute; width:var(--grid-size); height:var(--grid-size); background-position:center; background-repeat:no-repeat; background-size: 48px 48px; transform:translate(0,0); transition: transform .12s linear; pointer-events:none; z-index: var(--z-transport, 30); }
.vehicle-sprite[data-mode="bus"]  { background-image: url('../assets/images/vehicle_bus.png'); }
.vehicle-sprite[data-mode="bike"] { background-image: url('../assets/images/vehicle_bike.png'); }
.vehicle-sprite[data-mode="moto"] { background-image: url('../assets/images/vehicle_moto.png'); }

/* Parked vehicle markers on POI tiles */
.parked-vehicle { position:absolute; left:0; top:0; width:var(--grid-size); height:var(--grid-size); background-position:center; background-repeat:no-repeat; background-size:48px 48px; filter: drop-shadow(0 1px 1px rgba(0,0,0,.35)); z-index: var(--z-transport, 30); pointer-events:none; }
.parked-vehicle[data-mode="bike"] { background-image: url('../assets/images/vehicle_bike.png'); }
.parked-vehicle[data-mode="moto"] { background-image: url('../assets/images/vehicle_moto.png'); }

.toast { position:fixed; left:50%; bottom:16px; transform:translateX(-50%); background:#111827; color:#fff; padding:.6rem 1rem; border-radius:.6rem; box-shadow:0 6px 20px rgba(0,0,0,.3); opacity:0; pointer-events:none; transition:opacity .2s ease; }
.toast.show { opacity:1; }

.modal { position:fixed; inset:0; background:rgba(15, 23, 42, .45); display:grid; place-items:center; padding:1rem; opacity:0; pointer-events:none; transition:opacity .15s ease; z-index: var(--z-modal); }
.modal[aria-hidden="false"] { opacity:1; pointer-events:auto; }
.modal-content { width:min(760px, 96vw); background:#fff; border-radius:.8rem; border:1px solid #e2e8f0; box-shadow:0 20px 60px rgba(2,6,23,.18); }
.modal-header { display:flex; align-items:center; justify-content:space-between; padding:.75rem 1rem; border-bottom:1px solid #e2e8f0; }
.modal-body { padding:1rem; }
.choices { display:grid; gap:.5rem; }
.choice { display:flex; align-items:center; justify-content:space-between; border:1px solid #e2e8f0; padding:.6rem .8rem; border-radius:.6rem; background:#fff; }
.choice .meta { color:#64748b; font-size:.9rem; }

.menu-note { color:#64748b; font-size:.9rem; margin:.4rem 0; }
.inline { display:inline-flex; gap:.5rem; align-items:center; }

/* D-Pad */
.dpad { position:fixed; right:16px; bottom:16px; display:grid; gap:4px; align-items:center; justify-items:center; }
.dpad .mid { display:grid; grid-template-columns:repeat(2, 1fr); gap:4px; }
.dpad .dir { width:48px; height:42px; border-radius:.6rem; border:1px solid #cbd5e1; background:#fff; }

@media (max-width: 820px) { :root { --grid-size: 48px; } }
@media (prefers-reduced-motion: reduce) { .avatar { transition:none; } }
.decor-obstacles { background-image: url('../assets/images/obstacles_pack.png'); background-repeat:no-repeat; background-position: left bottom; background-size: 70% 70%; }

/* Path visualization lines */
.path-wrap { position:absolute; inset:0; pointer-events:none; z-index:2; }
.path-seg { position:absolute; background: var(--path-orange); }
.path-seg.dot { width: var(--path-thickness); height: var(--path-thickness); left: 50%; top: 50%; transform: translate(-50%, -50%); border-radius:999px; }
.path-seg.n { width: var(--path-thickness); height: calc(50% - var(--path-thickness) / 2); left: 50%; top: 0; transform: translateX(-50%); }
.path-seg.s { width: var(--path-thickness); height: calc(50% - var(--path-thickness) / 2); left: 50%; bottom: 0; transform: translateX(-50%); }
.path-seg.e { height: var(--path-thickness); width: calc(50% - var(--path-thickness) / 2); right: 0; top: 50%; transform: translateY(-50%); }
.path-seg.w { height: var(--path-thickness); width: calc(50% - var(--path-thickness) / 2); left: 0; top: 50%; transform: translateY(-50%); }
